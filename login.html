<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - SkillSwap</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>SkillSwap</h1>
    <p>Faça login ou crie sua conta</p>
  </header>

  <main style="max-width: 500px; margin: 2rem auto;">
    <div style="display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 2px solid #334155;">
      <button id="tabLogin" class="btn" style="background:#38bdf8;color:#0f172a;" onclick="showTab('login')">Login</button>
      <button id="tabRegister" class="btn" style="background:#1e293b;color:#cbd5e1;" onclick="showTab('register')">Cadastrar</button>
    </div>

    <div id="loginForm">
      <input type="email" id="loginEmail" placeholder="E-mail" required style="width:100%; padding:0.75rem; margin:0.5rem 0; border-radius:8px; border:1px solid #475569; background:#334155; color:#f1f5f9;" />
      <input type="password" id="loginPassword" placeholder="Senha" required style="width:100%; padding:0.75rem; margin:0.5rem 0; border-radius:8px; border:1px solid #475569; background:#334155; color:#f1f5f9;" />
      <button onclick="handleLogin()" class="btn" style="width:100%; background:#38bdf8; color:#0f172a; margin-top:1rem;">Entrar</button>
    </div>

    <div id="registerForm" style="display:none;">
      <input type="text" id="regName" placeholder="Nome completo" required style="width:100%; padding:0.75rem; margin:0.5rem 0; border-radius:8px; border:1px solid #475569; background:#334155; color:#f1f5f9;" />
      <input type="email" id="regEmail" placeholder="E-mail" required style="width:100%; padding:0.75rem; margin:0.5rem 0; border-radius:8px; border:1px solid #475569; background:#334155; color:#f1f5f9;" />
      <input type="password" id="regPassword" placeholder="Senha" required style="width:100%; padding:0.75rem; margin:0.5rem 0; border-radius:8px; border:1px solid #475569; background:#334155; color:#f1f5f9;" />
      <input type="text" id="regContact" placeholder="Contato (ex: WhatsApp)" style="width:100%; padding:0.75rem; margin:0.5rem 0; border-radius:8px; border:1px solid #475569; background:#334155; color:#f1f5f9;" />
      <button onclick="handleRegister()" class="btn" style="width:100%; background:#60a5fa; color:#0f172a; margin-top:1rem;">Cadastrar</button>
    </div>

    <p style="text-align:center; margin-top:1.5rem;">
      <a href="index.html" style="color:#38bdf8; text-decoration:underline;">← Voltar para o início</a>
    </p>
  </main>

  <script>
    const API_URL = 'https://back-end-tf-web-beryl.vercel.app';

    function showTab(tab) {
      document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
      document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
      
      document.getElementById('tabLogin').style.background = tab === 'login' ? '#38bdf8' : '#1e293b';
      document.getElementById('tabLogin').style.color = tab === 'login' ? '#0f172a' : '#cbd5e1';
      document.getElementById('tabRegister').style.background = tab === 'register' ? '#38bdf8' : '#1e293b';
      document.getElementById('tabRegister').style.color = tab === 'register' ? '#0f172a' : '#cbd5e1';
    }

    function handleLogin() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      fetch(`${API_URL}/usuarios`)
        .then(res => res.json())
        .then(users => {
          const user = users.find(u => u.email === email && u.password_hash === password);
          if (user) {
            localStorage.setItem('currentUser', JSON.stringify(user));
            alert(`Bem-vindo, ${user.name}!`);
            window.location.href = 'index.html';
          } else {
            alert('E-mail ou senha incorretos.');
          }
        });
    }

    function handleRegister() {
      const name = document.getElementById('regName').value;
      const email = document.getElementById('regEmail').value;
      const password = document.getElementById('regPassword').value;
      const contact = document.getElementById('regContact').value;

      fetch(`${API_URL}/usuarios`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, email, password, contact })
      })
      .then(res => res.json())
      .then(() => {
        alert('Cadastro realizado com sucesso!');
        showTab('login');
      });
    }
  </script>
</body>
</html>